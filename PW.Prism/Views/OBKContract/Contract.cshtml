@using PW.Ncels.Database.Models.OBK
@model OBKContractViewModel

@{
    var tab1 = "tab-1" + Model.Id;
    var tab1b = "#" + tab1;
    var tab2 = "tab-2" + Model.Id;
    var tab2b = "#" + tab2;
    var tab3 = "tab-3" + Model.Id;
    var tab3b = "#" + tab3;
}
<script src="~/Scripts/js/custom/subform-comment.js"></script>
<script src="~/Scripts/js/custom/atach-comment.js"></script>

<div id="@("contractLoader" + ViewBag.UiId)"></div>

@(Html.Kendo().Splitter()
                        .HtmlAttributes(new { @class = "pwSplitter k-block" })
            .Name(("splitter" + (string)ViewBag.UiId))
            .Panes(panes =>
            {
            panes.Add()
                .Size("300px")
                .Collapsible(true)
                .MaxSize("500px")
                .MinSize("300px")
                .Content(
                @<div class="pwPanelBar">
                    @(Html.Kendo().PanelBar().HtmlAttributes(new { @class = "pwPanelBar" })
                               .Name("panelbar" + (string)ViewBag.UiId)
                               .ExpandMode(PanelBarExpandMode.Multiple)
                               .ExpandAll(true)
                               .HtmlAttributes(new { style = "width:auto;", data_bind = "events: { select: contractCardTabSelect }" })
                               .Items(panelbar =>
                               {
                                   panelbar.Add().Expanded(true);
                                   panelbar.Add().Text("Структура договора")
                                                                   .Items(projects =>
                                                                   {
                                                                       projects.Add().Text("Карточка договора").HtmlAttributes(new { TabId = "contractDataTab1" + ViewBag.UiId }).Selected(true);
                                                                       projects.Add().Text("Вложения").HtmlAttributes(new { TabId = "contractDataTab2" + ViewBag.UiId });
                                                                       //projects.Add().Text("Вложения").HtmlAttributes(new { TabId = "contractDataTab3" + ViewBag.UiId });
                                                                   });

                               })
                    )
                </div>
                );

                panes.Add().Scrollable(false).Size("100%").Content(
                    @<div id="@("contractDataTabs" + ViewBag.UiId)" class="pwPageScrollable" style="background-color: white; margin-top: 10px">
                        <div id="@("contractDataTab1" + ViewBag.UiId)" class="row">
                            <div class="ibox-content">
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="tabs-container">
                                            <ul class="nav nav-tabs">
                                                <li class="active"><a data-toggle="tab" href="@tab1b">Общие сведения</a></li>
                                                <li class=""><a data-toggle="tab" href="@tab2b">Информация о заявляемой продукции</a></li>
                                                <li class=""><a data-toggle="tab" href="@tab3b">Стоимость работ</a></li>
                                            </ul>
                                            <div class="tab-content">
                                                <input type="hidden" id="modelId" value="@Model.Id.ToString()" />
                                                <div id="@tab1" class="tab-pane active">
                                                    <div class="panel-body">
                                                        <div class="row">
                                                            <div class="col-lg-6 b-r">
                                                                <div class="form-group">
                                                                    <label>Тип договора *</label>
                                                                    <div class="input-group">
                                                                        @Html.DropDownList("ContractType", (IEnumerable<SelectListItem>)(ViewBag.ContractTypes),
                                                                    String.Empty,
                                                                    new
                                                                    {
                                                                        @class = "form-control edit-control main-control",
                                                                        @disabled = "disabled"
                                                                    })
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-show="object.Type != null">
                                                                    @{
                                                                        var @checkedResident = ViewBag.declarant.IsResident ? "checked" : "";
                                                                        var @checkedNonResident = !ViewBag.declarant.IsResident ? "checked" : "";
                                                                    }
                                                                    <div class="radio-inline">
                                                                        <label><input type="radio" name="declarantisresident" value="true" disabled="disabled" @checkedResident>Резидент РК</label>
                                                                    </div>
                                                                    <div class="radio-inline">
                                                                        <label><input type="radio" name="declarantisresident" value="false" disabled="disabled" @checkedNonResident>Нерезидент РК</label>
                                                                    </div>
                                                                    <div class="radio-inline">
                                                                    </div>
                                                                </div>
                                                                @if (ViewBag.declarant.IsResident)
                                                                {
                                                                    <div class="form-group">
                                                                        <label>ИИН/БИН *</label>
                                                                        <div class="input-group">
                                                                            <input class="form-control" type="text" name="bin" disabled value="@ViewBag.declarant.Bin">
                                                                            <span class="input-group-addon">
                                                                                <a class="obkcontractdialog" href="#">
                                                                                    <i class="glyphicon glyphicon-info-sign"></i>
                                                                                </a>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                }
                                                                @if (!ViewBag.declarant.IsResident)
                                                                {
                                                                    <div class="form-group" ng-show="declarant.IsResident == false">
                                                                        <label>Страна</label>
                                                                        <div class="input-group">
                                                                            @Html.DropDownList(
                                                                   "CountryNonResident", (IEnumerable<SelectListItem>)(ViewBag.Countries), string.Empty, new { @class = "form-control edit-control main-control", disabled = "disabled" }
                                                                   )
                                                                            <span class="input-group-addon">
                                                                                <a class="obkcontractdialog" href="#">
                                                                                    <i class="glyphicon glyphicon-info-sign"></i>
                                                                                </a>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group" ng-show="declarant.IsResident == false">
                                                                        <label>Наименование на русском языке *</label>
                                                                        <div class="input-group">
                                                                            @Html.DropDownList(
                                                                   "NameNonResident", (IEnumerable<SelectListItem>)(ViewBag.NamesNonResidents), string.Empty, new { @class = "form-control edit-control main-control", disabled = "disabled" }
                                                                   )
                                                                            <span class="input-group-addon">
                                                                                <a class="obkcontractdialog" href="#">
                                                                                    <i class="glyphicon glyphicon-info-sign"></i>
                                                                                </a>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                }
                                                            </div>
                                                            <div class="col-lg-6 b-l">
                                                                <div class="form-group">
                                                                    <label>Экспертная организация</label>
                                                                    @*<ui-select ng-model="object.ExpertOrganization" theme="bootstrap" ng-disabled="object.viewMpde">
                                                                            <ui-select-match>{{$select.selected.Name}}</ui-select-match>
                                                                            <ui-select-choices repeat="item.Id as item in ExpertOrganizations | filter: $select.search">
                                                                                <div ng-bind-html="item.Name| highlight: $select.search"></div>
                                                                            </ui-select-choices>
                                                                        </ui-select>*@
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-lg-6 b-r">
                                                                <div class="form-group" ng-show="object.Type != null && showContactInformation">
                                                                    <h4>&nbsp;</h4>
                                                                    <input type="hidden" ng-model="declarant.Id" />
                                                                    <label>Организационная форма</label>
                                                                    <div class="input-group">
                                                                        @Html.DropDownList("OrganizationForm", (IEnumerable<SelectListItem>)(ViewBag.OrganizationForms),
                                                                   String.Empty,
                                                                    new
                                                                    {
                                                                        @class = "form-control edit-control main-control",
                                                                        @disabled = "disabled"
                                                                    })
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>Наименование на государственном языке *</label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="declarantNameKz" disabled value="@ViewBag.declarant.NameKz">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-show="object.Type != null && showContactInformation">
                                                                    <label>Наименование на русском языке *</label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="declarantNameRu" disabled value="@ViewBag.declarant.NameRu">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-show="object.Type != null && showContactInformation">
                                                                    <label>Наименование на английском языке</label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="declarantNameEn" disabled value="@ViewBag.declarant.NameEn">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group" ng-show="object.Type != null && showContactInformation">
                                                                    <label>Страна</label>
                                                                    <div class="input-group">
                                                                        @Html.DropDownList(
                                                                   "Country", (IEnumerable<SelectListItem>)(ViewBag.Countries), string.Empty, new { @class = "form-control edit-control main-control", disabled = "disabled" }
                                                                   )
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-6 b-l">
                                                                <div class="form-group" ng-show="object.Type != null && showContactInformation">
                                                                    <h4>Адрес</h4>
                                                                    <label>Юридический адрес * </label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="AddressLegalRu" disabled value="@Model.AddressLegalRu">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>Юридический адрес на казахском * </label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="AddressLegalKz" disabled value="@Model.AddressLegalKz">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>Фактический адрес * </label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="AddressFact" disabled value="@Model.AddressFact">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>Номер телефона * </label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="Phone" disabled value="@Model.Phone">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label>Адрес электронной почты * </label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="Email" disabled value="@Model.Email">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-lg-12">
                                                                <h4>Подписывающее лицо</h4>
                                                            </div>
                                                            <div>
                                                                <div class="row">
                                                                    <div class="col-lg-3">
                                                                        <div class="form-group">
                                                                            <label>Фамилия *</label>
                                                                            <div class="input-group">
                                                                                <input class="form-control" type="text" disabled value="@Model.BossLastName">
                                                                                <span class="input-group-addon">
                                                                                    <a class="obkcontractdialog" href="#">
                                                                                        <i class="glyphicon glyphicon-info-sign"></i>
                                                                                    </a>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-3">
                                                                        <div class="form-group">
                                                                            <label>Имя *</label>
                                                                            <div class="input-group">
                                                                                <input class="form-control" type="text" disabled value="@Model.BossFirstName">
                                                                                <span class="input-group-addon">
                                                                                    <a class="obkcontractdialog" href="#">
                                                                                        <i class="glyphicon glyphicon-info-sign"></i>
                                                                                    </a>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-3">
                                                                        <div class="form-group">
                                                                            <label>Отчество</label>
                                                                            <div class="input-group">
                                                                                <input class="form-control" type="text" disabled value="@Model.BossMiddleName">
                                                                                <span class="input-group-addon">
                                                                                    <a class="obkcontractdialog" href="#">
                                                                                        <i class="glyphicon glyphicon-info-sign"></i>
                                                                                    </a>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-lg-3">
                                                                        <div class="form-group">
                                                                            <label>Должность на русском языке *</label>
                                                                            <div class="input-group">
                                                                                <input ng-model="object.BossPosition" class="form-control" type="text" disabled value="@Model.BossPosition">
                                                                                <span class="input-group-addon">
                                                                                    <a class="obkcontractdialog" href="#">
                                                                                        <i class="glyphicon glyphicon-info-sign"></i>
                                                                                    </a>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-3">
                                                                        <div class="form-group">
                                                                            <label>Должность на казахском языке *</label>
                                                                            <div class="input-group">
                                                                                <input ng-model="object.BossPositionKz" class="form-control" type="text" disabled value="@Model.BossPositionKz">
                                                                                <span class="input-group-addon">
                                                                                    <a class="obkcontractdialog" href="#">
                                                                                        <i class="glyphicon glyphicon-info-sign"></i>
                                                                                    </a>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-12">
                                                                <h4>Действующее на основании</h4>
                                                            </div>
                                                            <div>
                                                                <div class="row">
                                                                    <div class="col-lg-6">
                                                                        <div class="form-group">
                                                                            <label>Вид документа *</label>
                                                                            <div class="input-group">
                                                                                @Html.DropDownList("BossDocType", (IEnumerable<SelectListItem>)ViewBag.DocTypes, string.Empty,
                                                                           new
                                                                           {
                                                                               @class = "form-control edit-control main-control",
                                                                               @disabled = "disabled"
                                                                           })
                                                                                <span class="input-group-addon">
                                                                                    <a class="obkcontractdialog" href="#">
                                                                                        <i class="glyphicon glyphicon-info-sign"></i>
                                                                                    </a>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-3">
                                                                        <div class="form-group">
                                                                            <div class="checkbox">
                                                                                @{
                                                                                    var bossDocUnlimitedChecked = Model.BossDocUnlimited ? "checked=\"checked\"" : "";
                                                                                }
                                                                                <label><input type="checkbox" value="" @bossDocUnlimitedChecked>Бессрочный</label>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <div class="form-group">
                                                                    <label>Наличие номера *</label>
                                                                    <div class="input-group">
                                                                        @Html.DropDownList("IsHasBossDocNumber", (IEnumerable<SelectListItem>)(ViewBag.BoolValues), string.Empty,
                                                                           new
                                                                           {
                                                                               @class = "form-control edit-control main-control",
                                                                               @disabled = "disabled"
                                                                           })
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <div class="form-group">
                                                                    <label>Номер документа</label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="BossDocNumber" disabled value="@Model.BossDocNumber">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <div class="form-group">
                                                                    <label>Дата начала действия *</label>
                                                                    <div class="input-group date">
                                                                        <input class="form-control" disabled value="@(Model.BossDocCreatedDate != null ? @Model.BossDocCreatedDate.Value.ToString("dd.MM.yyyy") : "")">
                                                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <div class="form-group">
                                                                    <label>Дата окончания действия *</label>
                                                                    <div class="input-group date">
                                                                        <input class="form-control" disabled value="@(Model.BossDocEndDate != null ? @Model.BossDocEndDate.Value.ToString("dd.MM.yyyy") : "")">
                                                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-12">
                                                                <h4>Банковские реквизиты</h4>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <div class="form-group">
                                                                    <label>ИИК (р/с) *</label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="BankIik" disabled value="@Model.BankIik">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <div class="form-group">
                                                                    <label>БИК *</label>
                                                                    <div class="input-group">
                                                                        <input class="form-control" type="text" name="BankBik" disabled value="@Model.BankBik">
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <div class="form-group">
                                                                    <label>Валюта *</label>
                                                                    <div class="input-group">
                                                                        @Html.DropDownList("Currency", (IEnumerable<SelectListItem>)(ViewBag.Currencies),
                                                                    String.Empty,
                                                                    new
                                                                    {
                                                                        @class = "form-control edit-control main-control",
                                                                        @disabled = "disabled"
                                                                    })
                                                                        <span class="input-group-addon">
                                                                            <a class="obkcontractdialog" href="#">
                                                                                <i class="glyphicon glyphicon-info-sign"></i>
                                                                            </a>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <div class="row">
                                                                    <div class="col-lg-6">
                                                                        <div class="form-group">
                                                                            <label>Наименование банка *</label>
                                                                            <div class="input-group">
                                                                                <input class="form-control" type="text" name="BankNameRu" disabled value="@Model.BankNameRu">
                                                                                <span class="input-group-addon">
                                                                                    <a class="obkcontractdialog" href="#">
                                                                                        <i class="glyphicon glyphicon-info-sign"></i>
                                                                                    </a>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <div class="row">
                                                                    <div class="col-lg-6">
                                                                        <div class="form-group">
                                                                            <label>Наименование банка на казахском языке *</label>
                                                                            <div class="input-group">
                                                                                <input class="form-control" type="text" name="BankNameKz" disabled value="@Model.BankNameKz">
                                                                                <span class="input-group-addon">
                                                                                    <a class="obkcontractdialog" href="#">
                                                                                        <i class="glyphicon glyphicon-info-sign"></i>
                                                                                    </a>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="@tab2" class="tab-pane">
                                                    @*@Html.Partial("~/Views/OBKContract/ProductView.cshtml", @Model)*@
                                                    @Html.Partial("~/Views/SafetyAssessment/ProductView.cshtml", (PW.Ncels.Database.DataModel.OBK_Contract)ViewBag.Contract)
                                                </div>
                                                <div id="@tab3" class="tab-pane">
                                                    @Html.Partial("~/Views/OBKContract/Price.cshtml", @Model.Id)
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="@("contractDataTab2" + ViewBag.UiId)" class="row hidden">
                            @Html.Partial("~/Views/SafetyAssessment/AttachFileView.cshtml", (IEnumerable<PW.Ncels.Database.Models.Common.FileGroup>)ViewBag.ListAttachments)
                        </div>
                        <div id="@("contractDataTab3" + ViewBag.UiId)" class="row hidden">
                            <div class="row">
                                @(Html.Kendo().Grid<PW.Ncels.Database.DataModel.FileLinkView>()
                  .Name("contractAttachesGrid" + (string)ViewBag.UiId)
                  .Columns(columns =>
                  {
                      columns.Bound(p => p.Category).Title("Категория").Hidden(true);
                      columns.Bound(p => p.Version).Title("Версия").Width(200);
                      columns.Bound(p => p.CreateDate).Format("{0:dd.MM.yyyy}").Title("Дата загрузки").Width(100);
                      columns.Bound(p => p.FileName).Title("Файл").ClientTemplate("<a href='/Upload/FileDownload?path=#= DocumentId #&id=#= CategoryId #&fileId=#= FilePath #'>#= FileName #'</a>");
                      columns.Bound(p => p.ParentFileName).Title("Название оригинала").Hidden(true);
                  })

                  .Resizable(resizable => resizable.Columns(true))
                  .Scrollable(scrollable => scrollable.Enabled(false))
                  .Selectable(selectable => selectable.Mode(GridSelectionMode.Single))
                  .HtmlAttributes(new { @class = "pwGrid", style = "height: 500px" })
                  .DataSource(dataSource => dataSource
                      .Ajax()
                      .PageSize(200)
                      .Aggregates(aggregates =>
                      {
                          aggregates.Add(f => f.Version).Count();
                      })
                      .Group(g => g.Add(f => f.Category))
                      .Sort(sort =>
                      {
                          sort.Add("ParentFileName").Ascending();
                          sort.Add("Version").Ascending();
                      })
                      .Read(read => read.Action("ListAttaches", "OBKContract", new { contractId = Model.Id }))
                  ))
                            </div>
                        </div>
                    </div>
                    );
            }))


<script>
    $(document).ready(function () {
        InitObkContractCard('@ViewBag.UiId');

    });
</script>
